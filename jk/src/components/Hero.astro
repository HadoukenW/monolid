---
import Swiper from 'swiper';
// init Swiper:
import { Image } from 'astro:assets';
import 'swiper/css/bundle';
import { getCollection } from "astro:content";
const posts = await getCollection('homepage');
---

<section>
        <h1 class="visually-hidden">Агентство недвижимости MonoliD</h1>
        <div class="swiper">
            <div class="swiper-wrapper">
                {posts.map(post => (
                    <div class="swiper-slide">
                        <div class="slide__texts">
                            <p class="slide__title">{post.data.title}</p>
                            <p class="slide__text">{post.data.description}</p>
                            
                            <div class="slide__btns">
                                <button class="swiper-prev"><svg width="24" height="20" viewBox="0 0 24 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.36609 9.11615L7.79492 4.68732C8.03902 4.44322 8.35891 4.32119 8.67883 4.32119C8.99875 4.32119 9.31863 4.44322 9.56273 4.68732C10.0509 5.17548 10.0509 5.96693 9.56273 6.45509L7.26777 8.75001L21.75 8.75001C22.4404 8.75001 23 9.30966 23 10C23 10.6904 22.4404 11.25 21.75 11.25L7.26777 11.25L9.56273 13.5449C10.0509 14.0331 10.0509 14.8245 9.56273 15.3127C9.07453 15.8009 8.28312 15.8009 7.79492 15.3127L3.36609 10.8839C2.87797 10.3958 2.87797 9.60427 3.36609 9.11615Z" fill="white"/></svg></button>
                                <button class="swiper-next"><svg width="24" height="20" viewBox="0 0 24 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M20.6339 10.8839L16.2051 15.3127C15.961 15.5568 15.6411 15.6788 15.3212 15.6788C15.0013 15.6788 14.6814 15.5568 14.4373 15.3127C13.9491 14.8245 13.9491 14.0331 14.4373 13.5449L16.7322 11.25H2.25C1.55965 11.25 1 10.6903 1 9.99999C1 9.30963 1.55965 8.74999 2.25 8.74999H16.7322L14.4373 6.45506C13.9491 5.9669 13.9491 5.17545 14.4373 4.68729C14.9255 4.19913 15.7169 4.19913 16.2051 4.68729L20.6339 9.11612C21.122 9.60424 21.122 10.3957 20.6339 10.8839Z" fill="white"/></svg></button>
                            </div>

                        </div>
                        <Image class="slide__img" src={post.data.image} alt={post.data.title}/>
                    </div>
                ))}

                
            </div>
            <form class="hero__form" action="">
                <button aria-label="Закрыть форму" class="menu-close-form">
                    <svg aria-hidden="true"  xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" width="512" height="512" x="0" y="0" viewBox="0 0 320.591 320.591" style="enable-background:new 0 0 512 512" xml:space="preserve"><g><path d="M30.391 318.583a30.37 30.37 0 0 1-21.56-7.288c-11.774-11.844-11.774-30.973 0-42.817L266.643 10.665c12.246-11.459 31.462-10.822 42.921 1.424 10.362 11.074 10.966 28.095 1.414 39.875L51.647 311.295a30.366 30.366 0 0 1-21.256 7.288z" fill="#000000" opacity="1" data-original="#000000"></path><path d="M287.9 318.583a30.37 30.37 0 0 1-21.257-8.806L8.83 51.963C-2.078 39.225-.595 20.055 12.143 9.146c11.369-9.736 28.136-9.736 39.504 0l259.331 257.813c12.243 11.462 12.876 30.679 1.414 42.922-.456.487-.927.958-1.414 1.414a30.368 30.368 0 0 1-23.078 7.288z"></path></g></svg>
                </button>
                <h2>Бесплатная консультация</h2>

                <div class="input-box">
                    <label for="hero__name"><input placeholder="Введите ваше имя" type="text" /></label>
                    <label for="hero__phone"><input class="phoneMask"  placeholder="Ваш номер телефона" type="tel" /></label>
                </div>

                <button class="input-box-btn">Записаться</button>
            </form>

            <div class="widget">
                <svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" width="512" height="512" x="0" y="0" viewBox="0 0 473.806 473.806" style="enable-background:new 0 0 512 512" xml:space="preserve" class=""><g><path d="M374.456 293.506c-9.7-10.1-21.4-15.5-33.8-15.5-12.3 0-24.1 5.3-34.2 15.4l-31.6 31.5c-2.6-1.4-5.2-2.7-7.7-4-3.6-1.8-7-3.5-9.9-5.3-29.6-18.8-56.5-43.3-82.3-75-12.5-15.8-20.9-29.1-27-42.6 8.2-7.5 15.8-15.3 23.2-22.8 2.8-2.8 5.6-5.7 8.4-8.5 21-21 21-48.2 0-69.2l-27.3-27.3c-3.1-3.1-6.3-6.3-9.3-9.5-6-6.2-12.3-12.6-18.8-18.6-9.7-9.6-21.3-14.7-33.5-14.7s-24 5.1-34 14.7l-.2.2-34 34.3c-12.8 12.8-20.1 28.4-21.7 46.5-2.4 29.2 6.2 56.4 12.8 74.2 16.2 43.7 40.4 84.2 76.5 127.6 43.8 52.3 96.5 93.6 156.7 122.7 23 10.9 53.7 23.8 88 26 2.1.1 4.3.2 6.3.2 23.1 0 42.5-8.3 57.7-24.8.1-.2.3-.3.4-.5 5.2-6.3 11.2-12 17.5-18.1 4.3-4.1 8.7-8.4 13-12.9 9.9-10.3 15.1-22.3 15.1-34.6 0-12.4-5.3-24.3-15.4-34.3l-54.9-55.1zm35.8 105.3c-.1 0-.1.1 0 0-3.9 4.2-7.9 8-12.2 12.2-6.5 6.2-13.1 12.7-19.3 20-10.1 10.8-22 15.9-37.6 15.9-1.5 0-3.1 0-4.6-.1-29.7-1.9-57.3-13.5-78-23.4-56.6-27.4-106.3-66.3-147.6-115.6-34.1-41.1-56.9-79.1-72-119.9-9.3-24.9-12.7-44.3-11.2-62.6 1-11.7 5.5-21.4 13.8-29.7l34.1-34.1c4.9-4.6 10.1-7.1 15.2-7.1 6.3 0 11.4 3.8 14.6 7l.3.3c6.1 5.7 11.9 11.6 18 17.9 3.1 3.2 6.3 6.4 9.5 9.7l27.3 27.3c10.6 10.6 10.6 20.4 0 31-2.9 2.9-5.7 5.8-8.6 8.6-8.4 8.6-16.4 16.6-25.1 24.4-.2.2-.4.3-.5.5-8.6 8.6-7 17-5.2 22.7l.3.9c7.1 17.2 17.1 33.4 32.3 52.7l.1.1c27.6 34 56.7 60.5 88.8 80.8 4.1 2.6 8.3 4.7 12.3 6.7 3.6 1.8 7 3.5 9.9 5.3.4.2.8.5 1.2.7 3.4 1.7 6.6 2.5 9.9 2.5 8.3 0 13.5-5.2 15.2-6.9l34.2-34.2c3.4-3.4 8.8-7.5 15.1-7.5 6.2 0 11.3 3.9 14.4 7.3l.2.2 55.1 55.1c10.3 10.2 10.3 20.7.1 31.3zM256.056 112.706c26.2 4.4 50 16.8 69 35.8s31.3 42.8 35.8 69c1.1 6.6 6.8 11.2 13.3 11.2.8 0 1.5-.1 2.3-.2 7.4-1.2 12.3-8.2 11.1-15.6-5.4-31.7-20.4-60.6-43.3-83.5s-51.8-37.9-83.5-43.3c-7.4-1.2-14.3 3.7-15.6 11s3.5 14.4 10.9 15.6zM473.256 209.006c-8.9-52.2-33.5-99.7-71.3-137.5s-85.3-62.4-137.5-71.3c-7.3-1.3-14.2 3.7-15.5 11-1.2 7.4 3.7 14.3 11.1 15.6 46.6 7.9 89.1 30 122.9 63.7 33.8 33.8 55.8 76.3 63.7 122.9 1.1 6.6 6.8 11.2 13.3 11.2.8 0 1.5-.1 2.3-.2 7.3-1.1 12.3-8.1 11-15.4z" fill="#000000"></path></g></svg>
            </div>
                        <!-- If we need pagination -->
            <div class="swiper-pagination"></div>

            <!-- If we need navigation buttons -->
            <div class="blurry"></div>
        </div>
</section>


<style lang="scss">


    .menu-close-form {
            display: none;
    
            &.active {
                display: flex;
                position: absolute;
                right: 10px;
                top: 10px;
            }
    
            svg {
                width: 20px;
                height: 20px;
                fill: var(--primary);
    
                path {
                    fill: var(--headers-primary);
                }
            }
    
            
        }
    
        @keyframes shake {
            0% {
                transform: rotateZ(0deg);
                -ms-transform: rotateZ(0deg);
                -webkit-transform: rotateZ(0deg);
            }
            10% {
                transform: rotateZ(-30deg);
                -ms-transform: rotateZ(-30deg);
                -webkit-transform: rotateZ(-30deg);
            }
            20% {
                transform: rotateZ(15deg);
                -ms-transform: rotateZ(15deg);
                -webkit-transform: rotateZ(15deg);
            }
            30% {
                transform: rotateZ(-10deg);
                -ms-transform: rotateZ(-10deg);
                -webkit-transform: rotateZ(-10deg);
            }
    
            40% {
                transform: rotateZ(7.5deg);
                -ms-transform: rotateZ(7.5deg);
                -webkit-transform: rotateZ(7.5deg);
            }
            50% {
                transform: rotateZ(-6deg);
                -ms-transform: rotateZ(-6deg);
                -webkit-transform: rotateZ(-6deg);
            }
            60% {
                transform: rotateZ(5deg);
                -ms-transform: rotateZ(5deg);
                -webkit-transform: rotateZ(5deg);
            }
            70% {
                transform: rotateZ(-4.28571deg);
                -ms-transform: rotateZ(-4.28571deg);
                -webkit-transform: rotateZ(-4.28571deg);
            }
    
            80% {
                transform: rotateZ(3.75deg);
                -ms-transform: rotateZ(3.75deg);
                -webkit-transform: rotateZ(3.75deg);
            }
            90% {
                transform: rotateZ(-3.33333deg);
                -ms-transform: rotateZ(-3.33333deg);
                -webkit-transform: rotateZ(-3.33333deg);
            }
    
            100% {
                transform: rotateZ(0deg);
                -ms-transform: rotateZ(0deg);
                -webkit-transform: rotateZ(0deg);
            }
        }
        .widget {
            display: none;
            background-color: var(--btn-primary);
            padding: 10px;
            border-radius: 50%;
            position: fixed;
            bottom: 25px;
            right: 25px;
            z-index: 20;
            width: 52px;
            height: 52px;
            cursor: pointer;

            svg {
                width: 100%;
                height: auto;
                animation: 1200ms ease 0s normal none 1 running shake;
                animation-iteration-count: infinite;
                -webkit-animation: 1200ms ease 0s normal none 1 running shake;
                -webkit-animation-iteration-count: infinite;
                path {
                    fill: var(--primary)
                }
            }

            @media(max-width: 992px) {
                display: flex;
            }

            @media(max-height: 800px) {
                display: flex;
            }
        }
    
        section {
            position: relative;
        }
    
        .slide__texts {
            background-color: #383c3eb0;
            color: var(--primary);
            padding: clamp(0.938rem, 0.521rem + 1.39vw, 1.563rem);
            max-width: 439px;
            min-height: clamp(8.75rem, 0.84rem + 26.37vw, 17.188rem);
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            left: 57px;
            display: flex;
            flex-direction: column;
    
            @media(max-width:992px) {
                transform: unset;
                left: 15px;
                top: 15px;
                height: unset;
            }

            @media(max-height: 800px) {
                transform: unset;
                left: 15px;
                top: 15px;
                height: unset;
                min-height: clamp(8.75rem, 5.208rem + 11.81vw, 14.063rem);
                
            }

            @media(max-width: 550px) {
                max-width: unset;
                left: 0;
                top: 0;
                width: 100%;
            }
            .slide__title {
                font-size: clamp(1.5rem, 0.333rem + 3.89vw, 3.25rem);
                font-weight: 500;

                @media(max-height: 800px) {
                    font-size: clamp(1.5rem, 0.917rem + 1.94vw, 2.375rem);
                }
            }
    
            .slide__text {
                font-size: clamp(1rem, 0.833rem + 0.56vw, 1.25rem);
                margin-top: clamp(0.625rem, 0.039rem + 1.95vw, 1.25rem);

                

                @media(max-height: 800px) {
                    font-size: 16px;
                }
            }
        }
        .slide__btns {
            margin-top: 20px;
    
            @media(max-width: 992px) {
              margin-top: 15px;  
            }
            @media(max-width: 550px) {
              display: none;  
            }
        }
        form {
            z-index: 5;
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            right: 57px;
            background-color: #383c3eb0;
            color: var(--primary);
            padding: 55px 20px;
            // height: 250px;
            display: flex;
            flex-direction: column;
            align-items: center;
            max-width: 375px;
    
            @media(max-width:992px) {
                display: none;
                
            }
    
            
    
            h2 {
                font-weight: 400;
                font-size: clamp(1.5rem, 1.031rem + 1.56vw, 2rem);
                text-align: center;
                
                margin-bottom: 20px;
    
                @media(max-width: 992px) {
                    max-width: unset;
                }
            }
            .input-box {
                display: flex;
                flex-direction: column;
                gap: 15px;
                
            }
            input {
                padding: 13px;
                border-radius: 5px;
                outline: none;
                border: 0;
                font-weight: 400;
                color: var(--headers-primary);
                font-size: 18px;
                border: 1px solid var(--headers-primary);
                @media(max-width: 992px) {
                }
            }
    
            .input-box-btn {
                color: var(--primary);
                padding: 7px 21px;
                background: var(--btn-primary);
                border-radius: 20px;
                display: flex;
                margin-top: 25px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 18px;
                line-height: 160%;
                transition: .3s ease background;
                &:hover {
                background: #0b1099;
                }
            }
        }
        .swiper {
            width: 100%;
            height: auto;
            
            .swiper-slide {
                width: 100%;
                position: relative;
                height: unset !important;
                img {
                    width: 100%;
                    max-height: 850px;
                    height: 100%;
                    object-fit: cover;
                    min-height: 350px;
                    @media(max-width:992px) {
                        height: 50dvh;
                    }
                    @media(max-width:550px) {
                        height: 25dvh;
                        
                        
                    }

                    @media(max-height: 800px) {
                       height: 80dvh;
                    }
                    
                }
    
                button {
                    background-color: var(--btn-primary);
                    padding: 12px;
                    border-radius: 100%;
                    transition: .3s ease all;
                    &:hover {
                        background: #0e14b4;
                    }
                }
    
                
            }
    
            
            
        }
    
        .hero__form {

            @media(max-height: 800px) {
                display: none;
            }

            &.active {
                position: fixed;
                max-width: 600px;
                width: 90%;
                display: flex;
                inset: 0;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                align-items: center;
                justify-content: center;
                padding: 0;
                z-index: 60;
                background-color: var(--primary);
                color: var(--headers-primary);
                padding: 40px 10px;
                height:min-content;
                
            }



            &.specific {
                position: fixed;
                max-width: 600px;
                width: 90%;
                display: flex;
                inset: 0;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                align-items: center;
                justify-content: center;
                padding: 0;
                z-index: 60;
                background-color: var(--primary);
                color: var(--headers-primary);
                padding: 40px 10px;
                height:min-content;
                border: 1px solid var(--headers-primary);
            }
        }
    
        .blurry {
            position: fixed;
            width: 100%;
            height: 100dvh;
            background-color: #0b0b0b;
            opacity: .8;
            inset: 0;
            z-index: 59;
            display: none;
    
            &.active {
                display: block;
                
            }
    
        }
    
    </style>



<script type="module">
    import Swiper from 'https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.mjs'
  
    const swiper = new Swiper('.swiper', {
  // Optional parameters
  direction: 'horizontal',
  loop: true,

  // If we need pagination
  pagination: {
    el: '.swiper-pagination',
    clickable: true
  },

  // Navigation arrows
  navigation: {
    nextEl: '.swiper-next',
    prevEl: '.swiper-prev',
  },

    autoplay: {
        delay: 5000,
    },

  effect: "fade",
  


})


const widget = document.querySelector('.widget')
const form = document.querySelector('.hero__form')
const blurry = document.querySelector('.blurry')
const close = document.querySelector('.menu-close-form')
const btnAction = document.querySelectorAll('.btn__action')
const body = document.querySelector('body')
    widget.addEventListener('click', e => {
        form.classList.add('active')
        blurry.classList.add('active')
        close.classList.add('active')
        body.classList.add('locked')
    })

    btnAction.forEach((item) => {
        item.addEventListener('click', e => {
            e.preventDefault() 
            form.classList.add('specific')
            blurry.classList.add('active')
            close.classList.add('active')
            body.classList.add('locked')
        })
    })

    
    blurry.addEventListener('click', e => {
        form.classList.remove('active')
        form.classList.remove('specific')
        blurry.classList.remove('active')
        close.classList.remove('active')
        body.classList.remove('locked')
        
    })
    close.addEventListener('click', e => {
        e.preventDefault()
        form.classList.remove('active')
        form.classList.remove('specific')
        blurry.classList.remove('active')
        close.classList.remove('active')
        body.classList.remove('locked')
        
    })
    window.addEventListener('resize', e => {
        if (window.innerWidth > 992) {
            form.classList.remove('active')
            form.classList.remove('specific')
            blurry.classList.remove('active')
            close.classList.remove('active')
            body.classList.remove('locked')
        }
    })
</script>